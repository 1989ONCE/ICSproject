import pandas as pd
import numpy as np
import statsmodels.api as sm
from statsmodels.tsa.api import VAR
import pickle, warnings, os
warnings.filterwarnings('ignore')


# rb: 用2位元度入
path = os.getcwd() + "/public/models/VAR1_code.pkl"
with open(path, 'rb') as file:
    model = pickle.load(file)

# sliding window, window size=31 
input = np.array([[7.21,29.72,1210.0,14.0,42.55], 
                  [7.21,29.72,1210.0,14.0,42.55], 
                  [7.21,29.72,1210.0,14.0,42.55],
                  [7.21,29.72,1210.0,14.0,42.55], 
                  [7.21,29.72,1210.0,14.0,42.55], 
                  [7.21,29.72,1210.0,14.0,42.55],
                  [7.21,29.72,1210.0,14.0,42.55], 
                  [7.21,29.72,1210.0,14.0,42.55], 
                  [7.21,29.72,1210.0,14.0,42.55],
                  [7.21,29.72,1210.0,14.0,42.55], 
                  [7.21,29.72,1210.0,14.0,42.55], 
                  [7.21,29.72,1210.0,14.0,42.55],
                  [7.21,29.72,1210.0,14.0,42.55], 
                  [7.21,29.72,1210.0,14.0,42.55], 
                  [7.21,29.72,1210.0,14.0,42.55],
                  [7.21,29.72,1210.0,14.0,42.55], 
                  [7.21,29.72,1210.0,14.0,42.55], 
                  [7.21,29.72,1210.0,14.0,42.55],
                  [7.21,29.72,1210.0,14.0,42.55], 
                  [7.21,29.72,1210.0,14.0,42.55], 
                  [7.21,29.72,1210.0,14.0,42.55],
                  [7.21,29.72,1210.0,14.0,42.55], 
                  [7.21,29.72,1210.0,14.0,42.55], 
                  [7.21,29.72,1210.0,14.0,42.55],
                  [7.21,29.72,1210.0,14.0,42.55], 
                  [7.21,29.72,1210.0,14.0,42.55], 
                  [7.21,29.72,1210.0,14.0,42.55],
                  [7.21,29.72,1210.0,14.0,42.55], 
                  [7.21,29.72,1210.0,14.0,42.55], 
                  [7.21,29.72,1210.0,14.0,42.55],
                  [7.21,29.72,1210.0,14.0,42.55]])

# array type
prediction = np.reshape(model.get('model_fitted').forecast(input, steps=1), -1)
print("predicted value of COD for next minute: ", prediction[-1])
file.close()


